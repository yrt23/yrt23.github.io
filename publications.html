<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Publications</title>
</head>
<body>

    <a href="index.html"><button>Home</button></a>

<h1>My Publications</h1>
<div id="publications"></div>

<!-- https://www.scopus.com/authid/detail.uri?authorId=57358462200  -->
Publication statistics from Yong Ren's <a href="https://www.scopus.com/authid/detail.uri?authorId=57358462200" target="_blank">Scopus Profile</a>.
<!-- Updated on XXX. -->
<script>
  // Make an API call to search for publications by an author
  // My API key: 4b8e54632816953189ca4f20bb12518f
  // Need to add these together <citedby-count>205</citedby-count>
    
    //fetch('https://api.elsevier.com/content/search/scopus?query=AU-ID(57358462200)&field=citedby-count&apiKey=4b8e54632816953189ca4f20bb12518f')
  //.then(response => response.json())
  //.then(data => {
    //// Display the number of publications found
    //const publicationsElement = document.getElementById('publications');
    //publicationsElement.innerHTML = `You have ${data.search-results.opensearch:totalResults} publications.`;
  //});
  
  //async function getCitedbyCount() {
  //try {
  //"use strict";
    fetch(`https://api.elsevier.com/content/search/scopus?query=AU-ID(57358462200)&field=citedby-count&apiKey=4b8e54632816953189ca4f20bb12518f`)
      // setup a promise
      // the function receives the response from fetch
      .then(function(resp){
          // convert it to text
          // this returns another promise
          //console.log(resp);
          //return resp.text();
          return resp.json();
      })
      .then(function(data){
        // Get the total number of publications
        const totalResults = data["search-results"]["opensearch:totalResults"] ;
        // console.log(totalResults);
        var totalCount = 0;
        //console.log(typeof totalCount);
        for (let index = 0; index < totalResults; index++) {
          let text_index = index.toString();
          // We can also use the unary plus operator (+) to convert a string into a floating point number.
          let indvCount = +data["search-results"]["entry"][text_index]["citedby-count"];
          // console.log(indvCount);
          // console.log(typeof indvCount);
          totalCount += indvCount;
        }
        //console.log(totalCount);
         // Display the number of publications found
      const publicationsElement = document.getElementById('publications');
      publicationsElement.innerHTML = `I have ` + totalResults + ` publications and ` + totalCount + ` citations.`;
      });
        
      // https://api.elsevier.com/content/search/scopus?query=AU-ID(57358462200)&field=publicationName,dc:title,prism:doi,prism:coverDate&apiKey=4b8e54632816953189ca4f20bb12518f    
  </script>  
</body>
</html>